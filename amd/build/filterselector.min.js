define(["jquery"],function(a){return{init:function(b,c,d){function e(){var b=a("#selectorSort").val();location.href=b}function f(b){var c=b.target.id,d=b.target.alt,e=b.target.src;e=e.replace(/width\/\d+/g,"width/150"),e=e.replace(/height\/\d+/g,"height/100"),a("#select_id").val(c),a("#select_name").html(d),a("#select_thumbnail").val(e),a("#submit_btn").prop("disabled",!1),a("#submit_btn").css({opacity:"1.0"})}function g(b){p!==!1&&clearTimeout(p),p=setTimeout(function(){var c=a(window).width(),d=a(window).height(),e=a(b).outerWidth(),f=a(b).outerHeight();a(b).css({left:(c-e)/2+"px",top:(d-f)/2+"px"})},200)}function h(b){if(a(this).blur(),a("#modal_window")[0])return!1;var c=document.documentElement,d=document.body;return n=c.scrollLeft||d.scrollLeft,o=c.scrollTop||d.scrollTop,a("body").append('<div id="selector_content"></div>'),a("body").append('<div id="modal_window"></div>'),a("#modal_window").fadeIn("slow"),g("#selector_content"),a("#selector_content").fadeIn("slow"),a("#selector_content").html('<iframe src="'+b+'" width="100%" height="100%">'),g("#selector_content"),a(parent.window).resize(function(){g("#selector_content")}),!0}function i(){window.scrollTo(n,o),a("#modal_window",parent.document).fadeOut("slow"),a("#modal_window",parent.document).remove(),a("#selector_content",parent.document).fadeOut("slow"),a("#selector_content",parent.document).remove()}function j(){var b=a("#select_id").val(),c=a("#select_name").html(),d=a("#select_thumbnail").val();if(null!==b&&""!==b){null!==a("#entry_id")&&a("#entry_id",parent.document).val(a("#select_id").val());var e=a("#id_name",parent.document);null!==e&&e.val(a("#select_name").html());var f="",g=a("#description_"+b);null!==g&&(f=g.html(),f=f.replace(/\n/g,"<br />")),f="<p>"+f+"<br /></p>";var h=a("#id_introeditoreditable",parent.document);null!==h&&(null!==f&&""!==f?h.html(f):h.html("")),h=a("#id_introeditor",parent.document),null!==h&&(null!==f&&""!==f?h.html(f):h.html("")),null!==a("#media_thumbnail",parent.document)&&(a("#media_thumbnail",parent.document).prop("src",d),a("#media_thumbnail",parent.document).prop("alt",c),a("#media_thumbnail",parent.document).prop("title",c));var j=a("#id_media_properties",parent.document);null!==j&&j.css({visibility:"visible"});var k=a("#submit_media",parent.document);null!==k&&k.prop("disabled",!1),i()}}function k(b){a("#id_add_media",parent.document).val(b)}function l(){}function m(){window.alert("3"),window.parent._doCancel()}var n=0,o=0,p=!1;a("#selectorSort").on("change",function(){e()}),"module"==d?(a("#id_add_media").on("click",function(){h(b)}),a("#submit_btn").on("click",function(){j()}),a("#cancel_btn").on("click",function(){i()}),a("#fadeout").on("click",function(){i()})):(a("#submit_btn").on("click",function(){l()}),window.alert("1"),a("#cancel_btn").on("click",function(){m()}),window.alert("2")),-1!=a(location).attr("pathname").indexOf("simple_selector.php")?a(".media_thumbnail").on("click",function(a){f(a)}):a("#media_thumbnail").on("change",function(){k(c)})}}});